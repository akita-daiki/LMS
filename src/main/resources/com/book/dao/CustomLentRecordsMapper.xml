<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.book.dao.CustomLentRecordsMapper">
	<resultMap id="BaseResultMap"
		type="com.book.entity.LentRecords">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Fri Dec 15 
			11:43:24 JST 2023. -->
		<id column="LENT_ID" jdbcType="INTEGER" property="lentId" />
		<result column="RECORDS_ID" jdbcType="INTEGER"
			property="recordsId" />
		<result column="BOOK_ID" jdbcType="INTEGER" property="bookId" />
		<result column="USER_ID" jdbcType="INTEGER" property="userId" />
		<result column="LENTDATE" jdbcType="TIMESTAMP"
			property="lentdate" />
		<result column="EXPECTED_RETURNDATE" jdbcType="TIMESTAMP"
			property="expectedReturndate" />
		<result column="RETURNDATE" jdbcType="TIMESTAMP"
			property="returndate" />
		<result column="LENTFLAG" jdbcType="INTEGER"
			property="lentflag" />
		<result column="CREATE_DATE" jdbcType="TIMESTAMP"
			property="createDate" />
		<result column="UPDATE_DATE" jdbcType="TIMESTAMP"
			property="updateDate" />
		<result column="DELETE_FLAG" jdbcType="INTEGER"
			property="deleteFlag" />
	</resultMap>
	<sql id="Base_Column_List">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Fri Dec 15 
			11:43:24 JST 2023. -->
		LENT_ID, RECORDS_ID, BOOK_ID, USER_ID, LENTDATE, EXPECTED_RETURNDATE,
		RETURNDATE,
		LENTFLAG, CREATE_DATE, UPDATE_DATE, DELETE_FLAG
	</sql>
	<!-- 連番採取 -->
	<select id="getLastRecordsId" resultType="java.lang.Integer">
		SELECT RECORDS_ID FROM
		lent_records ORDER BY RECORDS_ID DESC LIMIT 1
	</select>
	<!-- 返却時履歴更新 -->
	<update id="updateLentRecords"
		parameterType="com.book.entity.LentRecords">
		update lent_records
		set
		RETURNDATE = #{returndate,jdbcType=TIMESTAMP},
		LENTFLAG = #{lentflag,jdbcType=INTEGER},
		UPDATE_DATE = #{updateDate,jdbcType=TIMESTAMP}
		where BOOK_ID = #{bookId,jdbcType=INTEGER}
		and LENTFLAG = 1
	</update>
	<!-- 全件検索 -->
	<select id="findAll" resultType="com.book.entity.LentRecords">
		SELECT * FROM lent_records WHERE
		delete_flag = 0
	</select>
</mapper>